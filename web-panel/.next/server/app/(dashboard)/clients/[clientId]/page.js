(()=>{var e={};e.id=577,e.ids=[577],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},2694:e=>{"use strict";e.exports=require("http2")},8791:e=>{"use strict";e.exports=require("https")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},942:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>p,pages:()=>o,routeModule:()=>u,tree:()=>d}),s(8015),s(8032),s(5866),s(4752);var a=s(3191),r=s(8716),i=s(7922),n=s.n(i),l=s(5231),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);s.d(t,c);let d=["",{children:["(dashboard)",{children:["clients",{children:["[clientId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,8015)),"C:\\Users\\hy971\\source\\repos\\MyDietitianMobileApp\\web-panel\\app\\(dashboard)\\clients\\[clientId]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,8032)),"C:\\Users\\hy971\\source\\repos\\MyDietitianMobileApp\\web-panel\\app\\(dashboard)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,4752)),"C:\\Users\\hy971\\source\\repos\\MyDietitianMobileApp\\web-panel\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],o=["C:\\Users\\hy971\\source\\repos\\MyDietitianMobileApp\\web-panel\\app\\(dashboard)\\clients\\[clientId]\\page.tsx"],p="/(dashboard)/clients/[clientId]/page",m={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(dashboard)/clients/[clientId]/page",pathname:"/clients/[clientId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},6275:(e,t,s)=>{Promise.resolve().then(s.bind(s,5792))},5792:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var a=s(326),r=s(2473),i=s(7528),n=s(5047),l=s(7577),c=s(6824),d=s(6644),o=s(7736),p=s(3423),m=s(9062),u=s(9390),h=s(1021),x=s(3679),g=s(1441),y=s(6333),v=s(7888);async function f(e,t){let s=t.toISOString().split("T")[0];return(await c.Z.get(`/api/compliance/daily?clientId=${e}&date=${s}`)).data}function b(){let e=(0,n.useParams)(),t=(0,n.useRouter)(),s=e.clientId,[c,b]=(0,l.useState)(new Date),{data:j,isLoading:N,error:w,refetch:I,isRefetching:q}=(0,r.a)({queryKey:["daily-compliance",s,c.toISOString().split("T")[0]],queryFn:()=>f(s,c),refetchInterval:3e4,refetchIntervalInBackground:!0}),D=(0,l.useMemo)(()=>(function(){let e=[];for(let t=6;t>=0;t--){let s=new Date;s.setDate(s.getDate()-t),s.setHours(0,0,0,0),e.push(s)}return e})(),[]),P=(0,i.h)({queries:D.map(e=>({queryKey:["daily-compliance",s,e.toISOString().split("T")[0]],queryFn:()=>f(s,e),enabled:!!j,staleTime:6e4}))}),C=j?.meals.flatMap(e=>e.items).filter(e=>null!==e.markedAt).sort((e,t)=>e.markedAt&&t.markedAt?new Date(t.markedAt).getTime()-new Date(e.markedAt).getTime():0)[0]?.markedAt||null,k=j?.meals.map(e=>({mealId:e.mealId,mealType:e.mealType,mealName:e.mealName,compliancePercentage:e.compliancePercentage,items:e.items.map(e=>({mealItemId:e.mealItemId,ingredientId:e.ingredientId,ingredientName:e.ingredientName,isMandatory:e.isMandatory,status:function(e){switch(e){case 1:return"done";case 2:return"skipped";case 3:return"alternative";default:return null}}(e.status),markedAt:e.markedAt,alternativeIngredientId:e.alternativeIngredientId,alternativeIngredientName:e.alternativeIngredientName}))})),M=(0,l.useMemo)(()=>{let e=P.map((e,t)=>e.data?{date:D[t].toISOString().split("T")[0],compliance:e.data.dailyCompliancePercentage}:null).filter(e=>null!==e);if(0===e.length)return{average:0,bestDay:null,worstDay:null,trend:null,chartData:[]};let t=e.map(e=>e.compliance),s=t.reduce((e,t)=>e+t,0)/t.length,a=e.reduce((e,t)=>t.compliance>e.compliance?t:e),r=e.reduce((e,t)=>t.compliance<e.compliance?t:e),i=null;if(e.length>=6){let e=t.slice(0,3).reduce((e,t)=>e+t,0)/3,s=t.slice(-3).reduce((e,t)=>e+t,0)/3-e;i=2>Math.abs(s)?"stable":s>0?"up":"down"}return{average:s,bestDay:a,worstDay:r,trend:i,chartData:e}},[P,D]),A=(0,l.useMemo)(()=>{let e=[];if(M.average<50&&e.push({type:"warning",title:"Low Compliance",message:`Average compliance is ${M.average.toFixed(0)}%. Client may need additional support.`}),"down"===M.trend?e.push({type:"warning",title:"Declining Trend",message:"Compliance has been decreasing over the last few days. Consider checking in with the client."}):"up"===M.trend&&e.push({type:"positive",title:"Improving Trend",message:"Compliance is trending upward. Great progress!"}),j?.meals){let t=j.meals.filter(e=>1===e.mealType).flatMap(e=>e.items).filter(e=>2===e.status&&e.isMandatory).length;t>0&&e.push({type:"info",title:"Breakfast Compliance",message:`${t} mandatory breakfast item(s) skipped today.`})}return e},[M,j]),_=P.some(e=>e.isLoading);return N?(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)(h.Z,{className:"p-6",children:[a.jsx(g.O,{className:"h-8 w-48 mb-4"}),a.jsx(g.O,{className:"h-4 w-32"})]}),a.jsx("div",{className:"space-y-6",children:[void 0,void 0,void 0].map((e,t)=>(0,a.jsxs)(h.Z,{className:"p-6",children:[a.jsx(g.O,{className:"h-6 w-32 mb-4"}),a.jsx("div",{className:"space-y-3",children:[void 0,void 0].map((e,t)=>a.jsx(g.O,{className:"h-12 w-full"},t))})]},t))})]}):w?(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)(x.z,{variant:"secondary",onClick:()=>t.push("/dashboard/clients"),className:"flex items-center gap-2",children:[a.jsx(y.Z,{className:"w-4 h-4"}),"Back to Clients"]}),a.jsx(h.Z,{className:"p-12 text-center",children:(0,a.jsxs)("div",{className:"max-w-md mx-auto",children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-destructive/10 flex items-center justify-center mx-auto mb-6",children:a.jsx(v.Z,{className:"w-8 h-8 text-destructive"})}),a.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Failed to load client data"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:w instanceof Error?w.message:"Something went wrong. Please try again."}),a.jsx(x.z,{variant:"primary",onClick:()=>I(),disabled:q,children:"Retry"})]})})]}):j?(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)(x.z,{variant:"secondary",onClick:()=>t.push("/dashboard/clients"),className:"flex items-center gap-2",children:[a.jsx(y.Z,{className:"w-4 h-4"}),"Back to Clients"]}),a.jsx(d.D,{clientName:j.clientName,selectedDate:c,dailyCompliancePercentage:j.dailyCompliancePercentage,lastActivity:C,onDateChange:e=>{b(e)}}),!_&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsx(p.V,{averageCompliance:M.average,bestDay:M.bestDay,worstDay:M.worstDay,trend:M.trend}),a.jsx(m.H,{data:M.chartData})]}),A.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Insights"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:A.map((e,t)=>a.jsx(u.L,{type:e.type,title:e.title,message:e.message},t))})]})]}),(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-lg font-semibold text-foreground mb-4",children:"Daily Timeline"}),k&&k.length>0?a.jsx(o.f,{meals:k}):a.jsx(h.Z,{className:"p-12 text-center",children:a.jsx("p",{className:"text-muted-foreground",children:"No meals planned for this day"})})]})]}):null}},8015:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(8570).createProxy)(String.raw`C:\Users\hy971\source\repos\MyDietitianMobileApp\web-panel\app\(dashboard)\clients\[clientId]\page.tsx#default`)},8032:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var a=s(9510),r=s(1492),i=s(302);function n({children:e}){return a.jsx(r.Z,{children:a.jsx(i.L,{children:e})})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[74,115,778,564,429],()=>s(942));module.exports=a})();
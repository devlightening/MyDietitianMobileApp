(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[611],{9868:function(e,t,s){Promise.resolve().then(s.bind(s,57))},57:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return E}});var n=s(7437),r=s(2265),a=s(2464),i=s(9693),c=s(2884),l=s(9116);async function d(){return(await l.Z.get("/api/admin/ingredients")).data.ingredients||[]}async function o(e){return(await l.Z.post("/api/admin/ingredients",e)).data}async function u(e,t){return(await l.Z.put("/api/admin/ingredients/".concat(e),t)).data}async function m(e,t){return(await l.Z.patch("/api/admin/ingredients/".concat(e,"/toggle-active"),{isActive:t})).data}let x=["admin","ingredients"];var f=s(9379),h=s(4226),g=s(4630),p=s(5474),j=s(9688),N=s(8706);function v(e){let{ingredients:t,onEdit:s,onToggleActive:r}=e,a=(0,N.T)("admin.ingredients");return 0===t.length?null:(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full border-collapse",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"border-b border-border",children:[(0,n.jsx)("th",{className:"text-left p-4 font-semibold text-foreground",children:a("canonicalName")}),(0,n.jsx)("th",{className:"text-left p-4 font-semibold text-foreground",children:a("aliases")}),(0,n.jsx)("th",{className:"text-left p-4 font-semibold text-foreground",children:a("status")}),(0,n.jsx)("th",{className:"text-right p-4 font-semibold text-foreground",children:a("actions")})]})}),(0,n.jsx)("tbody",{children:t.map(e=>(0,n.jsxs)("tr",{className:"border-b border-border hover:bg-muted/50 transition-colors",children:[(0,n.jsx)("td",{className:"p-4",children:(0,n.jsx)("span",{className:e.isActive?"":"text-muted-foreground",children:e.canonicalName})}),(0,n.jsx)("td",{className:"p-4",children:e.aliases&&e.aliases.length>0?(0,n.jsx)("div",{className:"flex flex-wrap gap-1",children:e.aliases.map((e,t)=>(0,n.jsx)(f.C,{variant:"secondary",className:"text-xs",children:e},t))}):(0,n.jsx)("span",{className:"text-muted-foreground text-sm",children:"â€”"})}),(0,n.jsx)("td",{className:"p-4",children:(0,n.jsx)(f.C,{variant:"secondary",className:e.isActive?"bg-green-500/20 text-green-500 border-green-500/30":"",children:e.isActive?a("active"):a("passive")})}),(0,n.jsx)("td",{className:"p-4",children:(0,n.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,n.jsxs)(h.z,{variant:"secondary",onClick:()=>s(e),className:"text-sm px-3 py-1",children:[(0,n.jsx)(g.Z,{className:"w-4 h-4 mr-1"}),a("edit")]}),(0,n.jsx)(h.z,{variant:"secondary",onClick:()=>r(e.id,!e.isActive),className:"text-sm px-3 py-1",children:e.isActive?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Z,{className:"w-4 h-4 mr-1"}),a("deactivate")]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j.Z,{className:"w-4 h-4 mr-1"}),a("activate")]})})]})})]},e.id))})]})})}var b=s(8068),y=s(9178),w=s(2489),Z=s(9397),k=s(8930);function A(e){let{isOpen:t,onClose:s,onSubmit:a,initialData:i,isLoading:c=!1}=e,l=(0,N.T)("admin.ingredients"),d=(0,N.T)("common"),[o,u]=(0,r.useState)(""),[m,x]=(0,r.useState)([]),[f,g]=(0,r.useState)(""),[p,j]=(0,r.useState)(!0);if((0,r.useEffect)(()=>{i?(u(i.canonicalName),x(i.aliases||[]),j(i.isActive)):(u(""),x([]),j(!0)),g("")},[i,t]),!t)return null;let v=()=>{f.trim()&&!m.includes(f.trim())&&(x([...m,f.trim()]),g(""))},A=e=>{x(m.filter((t,s)=>s!==e))},C=o.trim()&&!c;return(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,n.jsx)(y.Z,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto m-4",children:(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-foreground",children:l(i?"editIngredient":"createIngredient")}),(0,n.jsx)(h.z,{variant:"secondary",onClick:s,className:"px-3 py-1",children:(0,n.jsx)(w.Z,{className:"w-4 h-4"})})]}),(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),o.trim()&&a({canonicalName:o.trim(),aliases:m.filter(e=>e.trim()),isActive:p})},className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{className:"block text-sm font-medium text-foreground mb-2",children:[l("canonicalName")," ",(0,n.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,n.jsx)(b.I,{value:o,onChange:e=>u(e.target.value),placeholder:l("canonicalNamePlaceholder"),required:!0,disabled:c})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:l("aliases")}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(b.I,{value:f,onChange:e=>g(e.target.value),placeholder:l("aliasPlaceholder"),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),v())},disabled:c}),(0,n.jsx)(h.z,{type:"button",variant:"secondary",onClick:v,disabled:!f.trim()||c,children:(0,n.jsx)(Z.Z,{className:"w-4 h-4"})})]}),m.length>0&&(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:m.map((e,t)=>(0,n.jsxs)("div",{className:"flex items-center gap-1 px-3 py-1 bg-muted rounded-md",children:[(0,n.jsx)("span",{className:"text-sm",children:e}),(0,n.jsx)("button",{type:"button",onClick:()=>A(t),className:"text-muted-foreground hover:text-foreground",disabled:c,children:(0,n.jsx)(k.Z,{className:"w-3 h-3"})})]},t))})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("input",{type:"checkbox",id:"isActive",checked:p,onChange:e=>j(e.target.checked),disabled:c,className:"w-4 h-4"}),(0,n.jsx)("label",{htmlFor:"isActive",className:"text-sm text-foreground",children:l("isActive")})]}),(0,n.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4",children:[(0,n.jsx)(h.z,{type:"button",variant:"secondary",onClick:s,disabled:c,children:d("cancel")}),(0,n.jsx)(h.z,{type:"submit",variant:"primary",disabled:!C,children:c?d("loading"):l(i?"update":"create")})]})]})]})})})}var C=s(6368),I=s(3694),O=s(3933),T=s(7233);function E(){let e=(0,N.T)("admin.ingredients"),t=(0,N.T)("common"),s=(0,N.T)("errors"),{data:l,isLoading:f,isError:g,error:p,refetch:j}=(0,a.a)({queryKey:x,queryFn:d,retry:1}),b=function(){let e=(0,i.NL)();return(0,c.D)({mutationFn:o,onSuccess:()=>{e.invalidateQueries({queryKey:x})}})}(),w=function(){let e=(0,i.NL)();return(0,c.D)({mutationFn:e=>{let{id:t,data:s}=e;return u(t,s)},onSuccess:()=>{e.invalidateQueries({queryKey:x})}})}(),k=function(){let e=(0,i.NL)();return(0,c.D)({mutationFn:e=>{let{id:t,isActive:s}=e;return m(t,s)},onSuccess:()=>{e.invalidateQueries({queryKey:x})}})}(),[E,R]=(0,r.useState)(!1),[S,D]=(0,r.useState)(null),[_,F]=(0,r.useState)(null),z=(e,t)=>{F({type:e,message:t}),setTimeout(()=>F(null),3e3)},L=async t=>{try{S?(await w.mutateAsync({id:S.id,data:t}),z("success",e("updateSuccess"))):(await b.mutateAsync(t),z("success",e("createSuccess"))),R(!1),D(null)}catch(t){z("error",t&&"object"==typeof t&&"code"in t?s((0,C.C)(t.code)):(null==t?void 0:t.message)||e("errorOccurred"))}},P=async(t,n)=>{try{await k.mutateAsync({id:t,isActive:n}),z("success",n?e("activateSuccess"):e("deactivateSuccess"))}catch(t){z("error",t&&"object"==typeof t&&"code"in t?s((0,C.C)(t.code)):(null==t?void 0:t.message)||e("errorOccurred"))}};if(f)return(0,n.jsxs)("div",{className:"space-y-8 p-6",children:[(0,n.jsx)("div",{className:"flex items-center justify-between",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-2xl font-semibold text-foreground",children:e("title")}),(0,n.jsx)("p",{className:"text-muted-foreground mt-1",children:e("subtitle")})]})}),(0,n.jsx)(y.Z,{className:"p-6",children:(0,n.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,n.jsx)(T.O,{className:"h-16 w-full"},t))})})]});if(g){let r=p&&"object"==typeof p&&"code"in p?s((0,C.C)(p.code)):p&&"object"==typeof p&&"message"in p?p.message:t("error");return(0,n.jsxs)("div",{className:"space-y-8 p-6",children:[(0,n.jsx)("div",{className:"flex items-center justify-between",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-2xl font-semibold text-foreground",children:e("title")}),(0,n.jsx)("p",{className:"text-muted-foreground mt-1",children:e("subtitle")})]})}),(0,n.jsx)(O.Z,{title:e("failedToLoad"),message:r,onRetry:()=>j(),retryLabel:t("retry")})]})}return(0,n.jsxs)("div",{className:"space-y-8 p-6",children:[_&&(0,n.jsx)("div",{className:"fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg ".concat("success"===_.type?"bg-green-500 text-white":"bg-red-500 text-white"),children:_.message}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-2xl font-semibold text-foreground",children:e("title")}),(0,n.jsx)("p",{className:"text-muted-foreground mt-1",children:e("subtitle")})]}),(0,n.jsxs)(h.z,{variant:"primary",onClick:()=>{D(null),R(!0)},children:[(0,n.jsx)(Z.Z,{className:"w-4 h-4 mr-2"}),e("createIngredient")]})]}),l&&0===l.length?(0,n.jsx)(I.Z,{title:e("noIngredients"),description:e("noIngredientsDescription")}):(0,n.jsx)(y.Z,{className:"p-6",children:(0,n.jsx)(v,{ingredients:l||[],onEdit:e=>{D(e),R(!0)},onToggleActive:P})}),(0,n.jsx)(A,{isOpen:E,onClose:()=>{R(!1),D(null)},onSubmit:L,initialData:S,isLoading:b.isPending||w.isPending})]})}},3694:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var n=s(7437),r=s(9178),a=s(5805);function i(e){let{title:t,description:s,action:i,icon:c}=e;return(0,n.jsx)(r.Z,{className:"p-12",children:(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center text-center space-y-4",children:[(0,n.jsx)("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-muted",children:c||(0,n.jsx)(a.Z,{className:"h-8 w-8 text-muted-foreground"})}),(0,n.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:t}),(0,n.jsx)("p",{className:"max-w-sm text-sm text-muted-foreground",children:s}),i&&(0,n.jsx)("div",{className:"pt-2",children:i})]})})}},3933:function(e,t,s){"use strict";s.d(t,{Z:function(){return c}});var n=s(7437),r=s(9178),a=s(4226),i=s(2252);function c(e){let{title:t,message:s,onRetry:c,retryLabel:l="Retry",isRetrying:d=!1}=e;return(0,n.jsx)(r.Z,{className:"p-12",children:(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center text-center space-y-4",children:[(0,n.jsx)("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-destructive/10",children:(0,n.jsx)(i.Z,{className:"h-8 w-8 text-destructive"})}),t&&(0,n.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:t}),(0,n.jsx)("p",{className:"max-w-sm text-sm text-muted-foreground",children:s}),c&&(0,n.jsx)("div",{className:"pt-2",children:(0,n.jsx)(a.z,{variant:"primary",onClick:c,disabled:d,children:l})})]})})}},9379:function(e,t,s){"use strict";s.d(t,{C:function(){return a}});var n=s(7437),r=s(4508);function a(e){let{children:t,variant:s="primary",className:a}=e;return(0,n.jsx)("span",{className:(0,r.cn)("inline-block px-3 py-1 rounded-full text-xs font-semibold bg-accent/10 text-accent","secondary"===s&&"bg-muted/20 text-muted-foreground","danger"===s&&"bg-danger/10 text-danger",a),children:t})}},4226:function(e,t,s){"use strict";s.d(t,{z:function(){return a}});var n=s(7437),r=s(4508);let a=(0,s(2265).forwardRef)((e,t)=>{let{variant:s="primary",loading:a,className:i,disabled:c,children:l,...d}=e;return(0,n.jsx)("button",{ref:t,disabled:c||a,className:(0,r.cn)("px-4 py-2 rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:ring-offset-background","primary"===s&&"bg-primary text-primary-foreground hover:bg-primary/90","secondary"===s&&"bg-secondary text-secondary-foreground hover:bg-secondary/80","danger"===s&&"bg-danger text-danger-foreground hover:bg-danger/90",(c||a)&&"opacity-60 cursor-not-allowed",i),...d,children:a?(0,n.jsx)("span",{className:"animate-pulse",children:"..."}):l})});a.displayName="Button"},9178:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var n=s(7437),r=s(4508);function a(e){let{className:t,children:s}=e;return(0,n.jsx)("div",{className:(0,r.cn)("rounded-xl bg-card border border-border shadow-sm transition-all duration-200",t),children:s})}},8068:function(e,t,s){"use strict";s.d(t,{I:function(){return a}});var n=s(7437),r=s(4508);let a=(0,s(2265).forwardRef)((e,t)=>{let{label:s,error:a,helperText:i,className:c,...l}=e;return(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[s&&(0,n.jsx)("label",{className:"text-sm font-medium text-foreground/80",children:s}),(0,n.jsx)("input",{ref:t,className:(0,r.cn)("border border-input rounded-md px-3 py-2 bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:ring-offset-background",a&&"border-danger",c),...l}),a?(0,n.jsx)("span",{className:"text-xs text-danger mt-1",children:a}):i&&(0,n.jsx)("span",{className:"text-xs text-muted-foreground mt-1",children:i})]})});a.displayName="Input"},7233:function(e,t,s){"use strict";s.d(t,{O:function(){return r}});var n=s(7437);function r(e){let{className:t="",...s}=e;return(0,n.jsx)("div",{className:"animate-pulse rounded bg-muted/60 "+t,...s})}s(2265)},9116:function(e,t,s){"use strict";let n=s(3464).Z.create({withCredentials:!0});n.interceptors.request.use(e=>e),n.interceptors.response.use(e=>e,e=>{var t,s,n,r,a,i,c,l,d,o;return(null===(t=e.response)||void 0===t?void 0:t.status)===401?(window.location.href="/auth/login",Promise.reject(e)):Promise.reject({status:null!==(c=null===(s=e.response)||void 0===s?void 0:s.status)&&void 0!==c?c:500,code:null!==(l=null===(r=e.response)||void 0===r?void 0:null===(n=r.data)||void 0===n?void 0:n.error)&&void 0!==l?l:"UNKNOWN_ERROR",message:null!==(o=null!==(d=null===(i=e.response)||void 0===i?void 0:null===(a=i.data)||void 0===a?void 0:a.message)&&void 0!==d?d:e.message)&&void 0!==o?o:"An unexpected error occurred"})}),t.Z=n},6368:function(e,t,s){"use strict";function n(e){return({DIETITIAN_NOT_FOUND:"dietitianNotFound",INGREDIENT_NOT_FOUND:"ingredientNotFound",UNAUTHORIZED:"unauthorized",NOT_FOUND:"notFound",INVALID_OPERATION:"invalidOperation",INVALID_ARGUMENT:"invalidArgument",INTERNAL_SERVER_ERROR:"serverError"})[e]||"generic"}s.d(t,{C:function(){return n}})},4508:function(e,t,s){"use strict";function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter(Boolean).join(" ")}s.d(t,{cn:function(){return n}})}},function(e){e.O(0,[675,311,464,284,971,117,744],function(){return e(e.s=9868)}),_N_E=e.O()}]);